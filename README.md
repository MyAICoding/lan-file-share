# LAN File Share

一个轻量级的局域网文件共享应用，允许用户在同一网络中方便地上传、下载和管理文件。

## 功能特性

- 🌐 **局域网文件共享** - 在同一网络内的设备间快速共享文件
- 📁 **文件管理** - 创建文件夹、浏览、删除文件和文件夹
- 📤 **拖拽上传** - 支持拖拽文件到浏览器上传
- 📥 **文件下载** - 直接下载共享的文件
- 🔧 **冲突处理** - 智能处理文件重名（重命名或覆盖）
- 📝 **文件预览** - 查看文本文件内容
- 💻 **跨设备兼容** - 支持手机、平板、电脑等各类设备
- 🔒 **路径安全** - 内置路径验证防止目录遍历攻击

## 技术栈

- **后端**: Node.js + Express.js
- **前端**: HTML5 + CSS3 + Vanilla JavaScript
- **文件处理**: Multer
- **跨域支持**: CORS

## 安装与使用

### 前置要求

- Node.js 14+ 版本
- npm 或 yarn 包管理器

### 安装步骤

1. **克隆或下载项目**
   ```bash
   cd lan-file-share
   ```

2. **安装依赖**
   ```bash
   npm install
   ```

3. **启动服务器**
   ```bash
   node server.js
   ```

4. **访问应用**
   - 服务器启动后，会输出本地网络 IP 地址
   - 在浏览器中打开显示的 URL，例如：`http://192.168.1.100:3000`
   - 也可以在同一网络的其他设备上访问该地址

## API 文档

### 获取文件列表
- **请求**: `GET /api/files?path=<目录路径>`
- **响应**: 文件及文件夹列表（包含名称、大小、修改时间等信息）

### 上传文件
- **请求**: `POST /api/upload`
  - 参数: `files` (FormData), `path` (目录路径), `conflictMode` (可选: 'overwrite' 或 'rename')
- **响应**: 上传结果和文件数量

### 检查文件是否存在
- **请求**: `POST /api/check-exists`
  - Body: `{ "filenames": [...], "path": "..." }`
- **响应**: 存在的文件名列表

### 创建文件夹
- **请求**: `POST /api/mkdir`
  - Body: `{ "folderName": "...", "currentPath": "..." }`
- **响应**: 创建成功标志

### 删除文件或文件夹
- **请求**: `DELETE /api/delete?path=<目标路径>`
- **响应**: 删除成功标志

### 读取文件内容
- **请求**: `GET /api/content?path=<文件路径>`
- **响应**: 文件的文本内容

## 目录结构

```
lan-file-share/
├── server.js              # Express 服务器主文件
├── package.json           # 项目依赖配置
├── package-lock.json      # 依赖版本锁定
├── public/
│   ├── index.html         # 前端 HTML 页面
│   ├── script.js          # 前端 JavaScript 脚本
│   └── style.css          # 前端样式表
├── uploads/               # 上传文件存储目录（自动创建）
└── README.md              # 项目说明文档
```

## 使用指南

### 基本操作

1. **浏览文件**
   - 打开应用后，自动显示 uploads 目录中的文件和文件夹
   - 点击文件夹可进入该目录，点击返回按钮可返回上级目录

2. **上传文件**
   - 方式一：点击"选择文件"按钮，选择要上传的文件
   - 方式二：直接拖拽文件到浏览器窗口进行上传
   - 如果存在重名文件，系统会自动重命名（如 file (1).txt）

3. **创建文件夹**
   - 点击"新建文件夹"按钮
   - 输入文件夹名称
   - 点击确认创建

4. **下载文件**
   - 点击文件名即可下载该文件

5. **删除文件**
   - 点击文件右侧的删除按钮
   - 确认删除操作

6. **预览文本文件**
   - 点击文本文件可在浏览器中预览其内容

## 配置选项

### 修改服务端口

编辑 `server.js` 文件，修改以下行：
```javascript
const PORT = 3000;  // 改为你需要的端口号
```

### 修改上传目录

编辑 `server.js` 文件，修改以下行：
```javascript
const baseUploadDir = path.join(__dirname, 'uploads');  // 改为你的目录路径
```

## 安全特性

- **路径验证**: 防止目录遍历攻击（../../../ 等）
- **安全路径解析**: 确保所有文件操作都在指定的上传目录内
- **CORS 支持**: 允许跨域访问，便于局域网内的设备通信

## 常见问题

### Q: 如何从其他设备访问？
**A**: 确保两台设备在同一局域网内，使用服务器显示的本地 IP 地址访问。例如 `http://192.168.1.100:3000`

### Q: 上传的文件在哪里？
**A**: 默认存储在项目根目录的 `uploads` 文件夹中

### Q: 支持上传多大的文件？
**A**: 默认无限制，但取决于服务器内存和磁盘空间。可以在 Multer 配置中设置限制

### Q: 如何在公网上使用？
**A**: 本应用设计用于局域网环境。如需公网使用，请考虑添加身份验证和加密传输

## 扩展功能建议

- 添加用户认证和权限管理
- 支持更多文件格式预览（PDF、图片、视频等）
- 添加文件搜索功能
- 支持批量操作（批量删除、批量下载）
- 添加日志记录和审计功能
- 支持文件压缩和解压

## 许可证

ISC

## 贡献

欢迎提交 Issue 和 Pull Request！

## 注意事项

- 该应用适用于受信任的网络环境
- 不建议在公网或不安全的网络上直接使用
- 定期备份重要文件，避免误删
- 大文件上传可能需要较长时间，请耐心等待
